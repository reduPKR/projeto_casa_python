{% extends "model-page.html" %}

{% block content %}
    <div align='center'>
        <br>
        <h3><i class="fas fa-list-alt"></i> Registrar manualmente</h3><br>
        <div class="col col-6 col-sm-6 col-md-4 col-lg-5 col-xs-4 container box-gray">
            <br>
            <div class="row">
                <div class="col">
                    <strong>Casa: </strong>
                    {{casa.nome}}
                </div>
                <div class="col">
                    <strong> Comodo: </strong>
                    {{casa.comodo.nome}}
                </div>
                <div class="col">
                    <strong> Equipamento: </strong>
                    {{casa.terminal.comodo_equipamento.equipamento.nome}}
                </div>
            </div><br>
            <div class="row">
                <div class="col">
                    <strong>Inicio: </strong>
                    <input type="time" id="horaIni" name="horaIni" value="12:00">
                    <strong>Fim: </strong>
                    <input type="time" id="horaFim" name="horaFim" value="12:00">
                    <button type="button" class="btn btn-secondary" onclick="adicionar()" >Adicionar</button>         
                </div>
            </div>
            <div class="row">
                <ul id="lista">
                </ul>              
            </div>
            <br>
            <form action="/gerar-testes/gerar/manual/selecionar/cadastar" method="POST"> {% csrf_token %}
                <input type="text" name="casa_id" value="{{casa.id}}" hidden>
                <input type="text" id="dados" name="dados" value="{{dados}}" hidden> 
                <button type="submit" class="btn btn-warning btn-block">
                    Finalizar
                </button>
            </form>
            <br>
            <a type="button" class="btn btn-warning"style="position: absolute; left: 10px;" href="/gerar-testes/gerar/manual/?id={{casa.id}}">
                <i class='fas fa-arrow-alt-circle-left'></i> Voltar
            </a>
            <br><br>
        </div>
    </div>

    <script>
        var aux = [];

        function adicionar() {
            var lista = document.getElementById('lista');
            var ini = document.getElementById('horaIni').value;
            var fim = document.getElementById('horaFim').value;

            var li = document.createElement('li');
            li.innerHTML = ini+" - "+fim;
            lista.appendChild(li);

            document.getElementById('horaIni').value='12:00';
            document.getElementById('horaFim').value='12:00';

            //teste           
            var dados = (document.getElementsByName('dados').length > 0)?document.getElementsByName('dados')[0]:null;

            if(aux.length == 0){
                aux = aux.concat(dados.value)
                aux.pop();
            }
                
            aux.push(ini)
            aux.push(fim)
            dados.value = aux;
            console.log(dados.value)
        }
        
    </script>
{% endblock %}
